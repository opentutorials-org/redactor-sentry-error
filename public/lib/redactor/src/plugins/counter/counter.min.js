Redactor.add("plugin","counter",{translations:{en:{counter:{words:"words",chars:"chars"}}},subscribe:{"editor.insert, editor.set, editor.empty":function(){this.count()}},loaded(){this.$editor=this.app.editor.getLayout(),this.$editor.on("keyup.rx-plugin-counter paste.rx-plugin-counter",this.count.bind(this)),this.count()},stop(){this.$editor?.off(".rx-plugin-counter"),this.app.statusbar.remove("words"),this.app.statusbar.remove("chars")},count(){let t=0,e=0,r=0,s=this.$editor?.html(),a,i,o;""!==(s=this._clean(s))&&(a=s.split(/\s+/),i=s.match(/\s/g),t=a?a.length:0,r=i?i.length:0,e=s.length),o={words:t,characters:e,spaces:r},this.app.broadcast("counter",o),this.app.statusbar.add("words",this.lang.get("counter.words")+": "+o.words),this.app.statusbar.add("chars",this.lang.get("counter.chars")+": "+o.characters)},_clean(t){var e=this.app.create("utils");return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/<!--[\s\S]*?-->\n?/g,"")).replace(/<\/(.*?)>/gi," ")).replace(/<(.*?)>/gi,"")).replace(/\t/gi,"")).replace(/\n/gi," ")).replace(/\r/gi," ")).replace(/&nbsp;/g,"1")).replace(/\s+/g," ")).trim(),t=e.removeInvisibleChars(t)}});