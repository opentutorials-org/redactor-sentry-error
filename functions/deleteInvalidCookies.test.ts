import { describe, it, expect, vi } from 'vitest';
import {
    deleteInvalidCookies,
    getCookiesAsObjects,
    deleteCookie,
    getStorageKey,
} from './deleteInvalidCookies';

const storageKey = 'sb-bfrztqescfrytlkwigbh-auth-token';
describe('deleteInvalidCookies', () => {
    it('should delete invalid cookies', () => {
        const cookies = [
            {
                name: storageKey + '.0',
                value: 'base64-eyJhY2Nlc3NfdG9rZW4iOiJleUpoYkdjaU9pSklVekkxTmlJc0ltdHBaQ0k2SWsxSmRuUTBlV3gzTTIwclVXOU5jM2NpTENKMGVYQWlPaUpLVjFRaWZRLmV5SnBjM01pT2lKb2RIUndjem92TDJKbWNucDBjV1Z6WTJaeWVYUnNhM2RwWjJKb0xuTjFjR0ZpWVhObExtTnZMMkYxZEdndmRqRWlMQ0p6ZFdJaU9pSmxZVEE0WlRGak5DMHdPR1ExTFRRNU1HVXRZalEzT0MxbVlXVXlPR1UxT0dRM01tWWlMQ0poZFdRaU9pSmhkWFJvWlc1MGFXTmhkR1ZrSWl3aVpYaHdJam94TnpNeU16UXdOemt3TENKcFlYUWlPakUzTXpJek16Y3hPVEFzSW1WdFlXbHNJam9pWkhWeWRVQjBZV3hyZEc5dFpXbHVhMjl5WldGdUxtTnZiU0lzSW5Cb2IyNWxJam9pSWl3aVlYQndYMjFsZEdGa1lYUmhJanA3SW5CeWIzWnBaR1Z5SWpvaVoyOXZaMnhsSWl3aWNISnZkbWxrWlhKeklqcGJJbWR2YjJkc1pTSXNJbWRwZEdoMVlpSmRmU3dpZFhObGNsOXRaWFJoWkdGMFlTSTZleUpoZG1GMFlYSmZkWEpzSWpvaWFIUjBjSE02THk5c2FETXVaMjl2WjJ4bGRYTmxjbU52Ym5SbGJuUXVZMjl0TDJFdlFVTm5PRzlqU21KRmFHVktaMjFZVDJWaGNFeDJjSHBRZEU4MWMydFRNREZIT0MxaU5ETk5lazlVZUdGU1VXOTRUbVp6V25rM2J6MXpPVFl0WXlJc0ltTjFjM1J2YlY5amJHRnBiWE1pT25zaWFHUWlPaUowWVd4cmRHOXRaV2x1YTI5eVpXRnVMbU52YlNKOUxDSmxiV0ZwYkNJNkltUjFjblZBZEdGc2EzUnZiV1ZwYm10dmNtVmhiaTVqYjIwaUxDSmxiV0ZwYkY5MlpYSnBabWxsWkNJNmRISjFaU3dpWm5Wc2JGOXVZVzFsSWpvaVJIVnlkU0JMWVc1bklpd2lhWE56SWpvaWFIUjBjSE02THk5aFkyTnZkVzUwY3k1bmIyOW5iR1V1WTI5dElpd2libUZ0WlNJNklrUjFjblVnUzJGdVp5SXNJbkJvYjI1bFgzWmxjbWxtYVdWa0lqcG1ZV3h6WlN3aWNHbGpkSFZ5WlNJNkltaDBkSEJ6T2k4dmJHZ3pMbWR2YjJkc1pYVnpaWEpqYjI1MFpXNTBMbU52YlM5aEwwRkRaemh2WTBwaVJXaGxTbWR0V0U5bFlYQk1kbkI2VUhSUE5YTnJVekF4UnpndFlqUXpUWHBQVkhoaFVsRnZlRTVtYzFwNU4yODljemsyTFdNaUxDSndjbVZtWlhKeVpXUmZkWE5sY201aGJXVWlPaUprZFhKMWRIUnRhV3NpTENKd2NtbDJZV041WDNCdmJHbGplVjlqYjI1elpXNTBYM1Z3WkdGMFpXUmZZWFFpT2lJeU1ESTBMVEV4TFRJd1ZEQTRPak0yT2pBMkxqVXhORm9pTENKd2NtbDJZV041WDNCdmJHbGplVjlqYjI1elpXNTBYM1psY25OcGIyNGlPaUl5TURJMExUWXRNakFpTENKd2NtOTJhV1JsY2w5cFpDSTZJakV4TkRFNU9UQXlOemsxTWpjNU16STJPVGs1T1NJc0luTjFZaUk2SWpFeE5ERTVPVEF5TnprMU1qYzVNekkyT1RrNU9TSXNJblJsY20xelgyOW1YM05sY25acFkyVmZZMjl1YzJWdWRGOTFjR1JoZEdWa1gyRjBJam9pTWpBeU5DMHhNUzB5TUZRd09Eb3pOam93TlM0M01qTmFJaXdpZEdWeWJYTmZiMlpmYzJWeWRtbGpaVjlqYjI1elpXNTBYM1psY25OcGIyNGlPaUl5TURJMExUWXRNakFpTENKMWMyVnlYMjVoYldVaU9pSmtkWEoxZEhSdGFXc2lmU3dpY205c1pTSTZJbUYxZEdobGJuUnBZMkYwWldRaUxDSmhZV3dpT2lKaFlXd3hJaXdpWVcxeUlqcGJleUp0WlhSb2IyUWlPaUp2WVhWMGFDSXNJblJwYldWemRHRnRjQ0k2TVRjek1UTXpOVGc1TUgxZExDSnpaWE56YVc5dVgybGtJam9pT1RoaFltTmpNMlV0TWpabU15MDBOVGhoTFRoallqZ3RaV0ptTkdRd1lqSmxNVGs0SWl3aWFYTmZZVzV2Ym5sdGIzVnpJanBtWVd4elpYMC5rZ0dqcUo5SEhiQ0lLQzRSellzT3VsMGVVR3Z2Yno3WTB2MHlJU3BlclBZIiwidG9rZW5fdHlwZSI6ImJlYXJlciIsImV4cGlyZXNfaW4iOjM2MDAsImV4cGlyZXNfYXQiOjE3MzIzNDA3OTAsInJlZnJlc2hfdG9rZW4iOiJqcWdRc1RHZVZsMllsNUp5SHNtVXpnIiwidXNlciI6eyJpZCI6ImVhMDhlMWM0LTA4ZDUtNDkwZS1iNDc4LWZhZTI4ZTU4ZDcyZiIsImF1ZCI6ImF1dGhlbnRpY2F0ZWQiLCJyb2xlIjoiYXV0aGVudGljYXRlZCIsImVtYWlsIjoiZHVydUB0YWxrdG9tZWlua29yZWFuLmNvbSIsImVtYWlsX2NvbmZpcm1lZF9hdCI6IjIwMjMtMTAtMjdUMDI6MTg6MTUuNzk1OTEzWiIsInBob25lIjoiIiwiY29uZmlybWVkX2F0IjoiMjAyMy0xMC0yN1QwMjoxODoxNS43OTU5MTNaIiwibGFzdF9zaWduX2luX2F0IjoiMjAyNC0xMS0xMVQxNDozODoxMC40OTM5MTNaIiwiYXBwX21ldGFkYXRhIjp7InByb3ZpZGVyIjoiZ29vZ2xlIiwicHJvdmlkZXJzIjpbImdvb2dsZSIsImdpdGh1YiJdfSwidXNlcl9tZXRhZGF0YSI6eyJhdmF0YXJfdXJsIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSmJFaGVKZ21YT2VhcEx2cHpQdE81c2tTMDFHOC1iNDNNek9UeGFSUW94TmZzWnk3bz1zOTYtYyIsImN1c3RvbV9jbGFpbXMiOnsia',
            },
            {
                name: storageKey + '.1',
                value: 'GQiOiJ0YWxrdG9tZWlua29yZWFuLmNvbSJ9LCJlbWFpbCI6ImR1cnVAdGFsa3RvbWVpbmtvcmVhbi5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiZnVsbF9uYW1lIjoiRHVydSBLYW5nIiwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tIiwibmFtZSI6IkR1cnUgS2FuZyIsInBob25lX3ZlcmlmaWVkIjpmYWxzZSwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0piRWhlSmdtWE9lYXBMdnB6UHRPNXNrUzAxRzgtYjQzTXpPVHhhUlFveE5mc1p5N289czk2LWMiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJkdXJ1dHRtaWsiLCJwcml2YWN5X3BvbGljeV9jb25zZW50X3VwZGF0ZWRfYXQiOiIyMDI0LTExLTIwVDA4OjM2OjA2LjUxNFoiLCJwcml2YWN5X3BvbGljeV9jb25zZW50X3ZlcnNpb24iOiIyMDI0LTYtMjAiLCJwcm92aWRlcl9pZCI6IjExNDE5OTAyNzk1Mjc5MzI2OTk5OSIsInN1YiI6IjExNDE5OTAyNzk1Mjc5MzI2OTk5OSIsInRlcm1zX29mX3NlcnZpY2VfY29uc2VudF91cGRhdGVkX2F0IjoiMjAyNC0xMS0yMFQwODozNjowNS43MjNaIiwidGVybXNfb2Zfc2VydmljZV9jb25zZW50X3ZlcnNpb24iOiIyMDI0LTYtMjAiLCJ1c2VyX25hbWUiOiJkdXJ1dHRtaWsifSwiaWRlbnRpdGllcyI6W3siaWRlbnRpdHlfaWQiOiJkZTNmOTZkZi1iOGI2LTQ3MzctODc1Yi0xNzhlMzA3NjdmMzMiLCJpZCI6IjExNDE5OTAyNzk1Mjc5MzI2OTk5OSIsInVzZXJfaWQiOiJlYTA4ZTFjNC0wOGQ1LTQ5MGUtYjQ3OC1mYWUyOGU1OGQ3MmYiLCJpZGVudGl0eV9kYXRhIjp7ImF2YXRhcl91cmwiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NKYkVoZUpnbVhPZWFwTHZwelB0TzVza1MwMUc4LWI0M016T1R4YVJRb3hOZnNaeTdvPXM5Ni1jIiwiY3VzdG9tX2NsYWltcyI6eyJoZCI6InRhbGt0b21laW5rb3JlYW4uY29tIn0sImVtYWlsIjoiZHVydUB0YWxrdG9tZWlua29yZWFuLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJmdWxsX25hbWUiOiJEdXJ1IEthbmciLCJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJuYW1lIjoiRHVydSBLYW5nIiwicGhvbmVfdmVyaWZpZWQiOmZhbHNlLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSmJFaGVKZ21YT2VhcEx2cHpQdE81c2tTMDFHOC1iNDNNek9UeGFSUW94TmZzWnk3bz1zOTYtYyIsInByb3ZpZGVyX2lkIjoiMTE0MTk5MDI3OTUyNzkzMjY5OTk5Iiwic3ViIjoiMTE0MTk5MDI3OTUyNzkzMjY5OTk5In0sInByb3ZpZGVyIjoiZ29vZ2xlIiwibGFzdF9zaWduX2luX2F0IjoiMjAyMy0xMC0yN1QwMjoxODoxNS43ODg3NloiLCJjcmVhdGVkX2F0IjoiMjAyMy0xMC0yN1QwMjoxODoxNS43ODg4WiIsInVwZGF0ZWRfYXQiOiIyMDI0LTExLTExVDE0OjM4OjA4LjcyMDgxNloiLCJlbWFpbCI6ImR1cnVAdGFsa3RvbWVpbmtvcmVhbi5jb20ifSx7ImlkZW50aXR5X2lkIjoiNzA2YWVjMjgtODYwMi00ODNhLWI2YTEtZDQ3ZjA1NzI1NDVhIiwiaWQiOiI2NjI0Njk4NSIsInVzZXJfaWQiOiJlYTA4ZTFjNC0wOGQ1LTQ5MGUtYjQ3OC1mYWUyOGU1OGQ3MmYiLCJpZGVudGl0eV9kYXRhIjp7ImF2YXRhcl91cmwiOiJodHRwczovL2F2YXRhcnMuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3UvNjYyNDY5ODU_dj00IiwiZW1haWwiOiJkdXJ1QHRhbGt0b21laW5rb3JlYW4uY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImZ1bGxfbmFtZSI6ImR1cnV0dG1payIsImlzcyI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20iLCJuYW1lIjoiZHVydXR0bWlrIiwicGhvbmVfdmVyaWZpZWQiOmZhbHNlLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJkdXJ1dHRtaWsiLCJwcm92aWRlcl9pZCI6IjY2MjQ2OTg1Iiwic3ViIjoiNjYyNDY5ODUiLCJ1c2VyX25hbWUiOiJkdXJ1dHRtaWsifSwicHJvdmlkZXIiOiJnaXRodWIiLCJsYXN0X3NpZ25faW5fYXQiOiIyMDIzLTExLTE5VDAxOjI5OjA1LjQ5NzgwMloiLCJjcmVhdGVkX2F0IjoiMjAyMy0xMS0xOVQwMToyOTowNS40OTc4NDhaIiwidXBkYXRlZF9hdCI6IjIwMjMtMTItMTBUMTE6MzQ6NDIuMDQzNzQ5WiIsImVtYWlsIjoiZHVydUB0YWxrdG9tZWlua29yZWFuLmNvbSJ9XSwiY3JlYXRlZF9hdCI6IjIwMjMtMTAtMjdUMDI6MTg6MTUuNzc4ODI5WiIsInVwZGF0ZWRfYXQiOiIyMDI0LTExLTIzVDA0OjQ2OjMwLjQ5OTMzNloiLCJpc19hbm9ueW1vdXMiOmZhbHNlfX0',
            },
        ];
        const deleteCallback = vi.fn();

        deleteInvalidCookies(cookies, storageKey, deleteCallback);

        expect(deleteCallback).toHaveBeenCalledTimes(2);
    });
});
