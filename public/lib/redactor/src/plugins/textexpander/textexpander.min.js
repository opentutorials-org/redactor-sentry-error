Redactor.add("plugin","textexpander",{defaults:{items:!1},start(){this.opts.is("textexpander.items")&&(this.$editor=this.app.editor.getEditor(),this.$editor.on("keyup.rx-plugin-textexpander",this._expand.bind(this)))},stop(){this.$editor.off(".rx-plugin-textexpander")},_expand(e){e=e.which;if(e===this.app.keycodes.SPACE){var t,i,e=this.opts.get("textexpander.items"),r=this.app.create("utils"),p=this.app.create("selection");for([t,i]of Object.entries(e)){var s=new RegExp(r.escapeRegExp(t)+"\\s$"),a=t.length+1;let e=p.getText("before",a);if(e=e&&e.trim(),t===e)return this._replaceSelection(s,i)}}},_replaceSelection(e,t){var i=this.app.create("marker");i.insert();let r=i.find("start"),p=r.previousSibling,s=p.textContent;s=(s=s.replace(/&nbsp;/," ")).replace(e,t),p.textContent=s,i.remove()}});